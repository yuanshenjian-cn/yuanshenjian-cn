# Code Reviewer - 代码规范审查助手

这是一个专门用于代码质量审查的 opencode subagent，能够自动分析代码并提供改进建议。

## 功能特性

### 1. TypeScript 类型安全检查
- 识别 `any` 类型的滥用
- 验证函数参数和返回类型完整性
- 检查类型断言（`as`）的合理性
- 确保严格模式下的类型合规性

### 2. 命名规范审查
- 组件/类：PascalCase（如 `UserCard`）
- 变量/函数：camelCase（如 `getUserData`）
- 常量：UPPER_SNAKE_CASE（如 `MAX_COUNT`）
- 文件名与默认导出保持一致

### 3. 代码风格和一致性
- 检查缩进和空格的一致性
- 验证引号使用（单引号/双引号）
- 检查分号使用
- 验证导入语句的顺序

### 4. 代码异味和反模式识别
- 重复代码（DRY 原则）
- 过长的函数/组件（建议不超过 50 行）
- 深层嵌套（建议不超过 3 层）
- 魔法数字和硬编码字符串
- 不必要的复杂性

### 5. 最佳实践检查
- React：组件单一职责、正确使用 hooks
- 异步：正确错误处理、避免回调地狱
- 性能：避免不必要的重渲染、合理使用 memo

## 使用方法

### 触发方式

你可以通过以下关键词触发代码审查：

```
@opencode review <文件路径>
@opencode 审查 <文件路径>
@opencode 代码审查 <文件路径>
@opencode code review <文件路径>
@opencode 检查代码 <文件路径>
```

### 示例

```
@opencode review src/components/Button.tsx
```

## 审查报告格式

代码审查完成后，会输出格式化的审查报告：

```
### 🔴 严重 / 🟡 警告 / 🟢 建议

**位置**: `文件路径:行号`

**问题**: 具体问题描述

**建议**: 如何修复

**示例**: 
```typescript
// 修复前的代码
// 修复后的代码
```
```

### 总结

最后会提供：
- 问题总数统计（严重/警告/建议）
- 整体代码质量评分（1-10）
- 优先级最高的 3 个改进建议

## 配置说明

### 支持的文件类型

- TypeScript (`.ts`)
- TypeScript React (`.tsx`)
- JavaScript (`.js`)
- JavaScript React (`.jsx`)

### 配置文件位置

```
.opencode/subagents/code-reviewer/
├── config.json    # 主要配置
└── README.md      # 说明文档
```

## 最佳实践

1. **定期审查**: 建议每次提交代码前都进行自动审查
2. **逐步改进**: 优先处理严重问题，再处理警告和建议
3. **团队共识**: 确保团队对代码规范有一致的理解
4. **持续学习**: 关注新的最佳实践和模式

## 注意事项

- 代码审查助手提供的是建议，最终决策权在开发者
- 某些规则可能需要根据项目实际情况调整
- 对于遗留代码，可以逐步重构而非一次性重写
