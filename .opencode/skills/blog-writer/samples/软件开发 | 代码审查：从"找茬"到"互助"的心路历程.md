# 程序员 | 代码审查：从"找茬"到"互助"的心路历程

刚入行那几年，我对代码审查（Code Review）充满抵触情绪。每次收到同事的Review请求，第一反应是"又来了，又要挑我的毛病"；而审查别人的代码时，也常常陷入"鸡蛋里挑骨头"的纠结，生怕漏掉任何问题。那时的我，把Code Review当成了找茬工具，而不是学习机会。

直到后来在阿里的一次项目重构中，一位资深架构师改变了我对这个问题的认知。他说："Code Review不是为了证明谁比谁厉害，而是为了让整个团队的代码质量都能提升。"

这句话让我开始重新审视Code Review的价值，也逐渐摸索出一套行之有效的实践方法。

## ** 从对抗到协作的心态转变**

早期的Code Review经常充满火药味。审查者用居高临下的语气指出问题："这里为什么这么写？"、"这种方式不好"，被审查者则觉得自己被针对，情绪对立。

后来我意识到，问题的根源不在于技术，而在于沟通方式。同样是指出问题，不同的表达方式效果天差地别：

**对抗式**："你这个变量命名不对，改成xxx"
**协作式**："我建议把变量名改成xxx，这样能让代码意图更清晰，你觉得呢？"

关键在于把"你vs我"的对立关系，转变为"我们vs问题"的协作关系。审查者不是在挑错，而是在帮助提升；被审查者不是在被批评，而是在获得成长机会。

## ** Code Review的四个层次**

经过多年实践，我总结出Code Review应该关注的四个层次，由浅入深依次是：

### 第一层：正确性
- 逻辑错误、边界条件处理
- 异常处理是否完整
- 资源泄漏风险（内存、连接、文件句柄）

### 第二层：可读性
- 变量命名是否表意清晰
- 函数是否职责单一
- 复杂逻辑是否有注释说明

### 第三层：可维护性
- 是否符合SOLID原则
- 代码结构是否易于扩展
- 是否有适当的抽象和解耦

### 第四层：工程实践
- 单元测试覆盖率
- 文档是否完善
- 是否引入了不必要的技术债务

实践中，我建议Review时由浅入深，先确保正确性，再关注可读性和可维护性。不要一次Review试图解决所有问题，那样会让人难以接受。

## ** 我的Code Review实践清单**

### 作为被审查者
1. **自Review先行**：提交前自己先Review一遍，能发现80%的低级问题
2. **附上说明**：在PR描述中说明设计思路、关键改动、待讨论点
3. **小步提交**：控制PR的规模，一次改动不超过400行
4. **响应及时**：收到Review意见后及时回应或修改

### 作为审查者
1. **先理解再评论**：确保理解了代码意图再提出意见
2. **意见分类**：用[Must] [Should] [Could]标记意见优先级
3. **解释原因**：不仅指出问题，更要说明为什么这样更好
4. **肯定优点**：也指出代码写得好、值得学习的地方

### 具体实践
- **使用工具**：利用GitHub/GitLab的Review功能，支持行级评论
- **设置时限**：普通PR24小时内完成Review，紧急PR2小时内
- **双人对签**：核心代码要求至少两人Approve才能合并

## ** Code Review的价值远不止找Bug**

除了发现Bug，Code Review至少还有三重价值：

**知识传播**：通过Review不同模块的代码，快速了解系统全貌。新人可以通过Review前辈的代码学习最佳实践。

**团队共识**：在Review中讨论编码风格、设计模式，逐渐形成团队的代码规范。比写死板的文档更有效。

**个人成长**：被Review时获得反馈，Review他人时学习新思路。我很多技术提升都来自同事在Review中分享的经验。

## ** 拥抱Code Review，拥抱持续成长**

这些年，我从抵触Code Review到主动寻求Review，心态的变化源于认知的转变：Code Review不是对个人能力的质疑，而是团队协作的重要方式，是持续学习和成长的机会。

对于个人而言，Code Review是提升代码质量最快的方式之一。别人的眼光能看到你注意不到的盲点；别人的经验能帮你避坑；别人的质疑能逼你思考得更深入。

对于团队而言，Code Review是建立技术共识、传播知识、保证质量的有效手段。一个健康的Code Review文化，能让团队的代码质量持续提升。

如果你还在为Code Review苦恼，不妨换个角度看它：这不是找茬，而是一起把代码写好的机会。主动寻求Review，认真对待每条意见，你的技术成长会加速。

毕竟，代码写出来是给别人看的，多人Review能让代码更健壮，也能让我们写出更专业的代码。这大概就是"代码是写给人看的，只是顺便能运行"这句话的真谛吧。

愿我们都能在Code Review中互相成就，共同成长。
