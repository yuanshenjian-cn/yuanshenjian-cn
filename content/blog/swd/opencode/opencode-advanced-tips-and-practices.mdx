---
title: OpenCode 进阶指南：提升编程效率的技巧
date: '2026-02-07'
tags:
  - 软件开发
  - AI编程
  - 效率工具
  - OpenCode
published: true
brief: >-
  掌握 OpenCode 的进阶使用技巧，从初级自然语言提问到高级自定义配置，通过实战案例学习如何用 AI Coding Agent 提升编码效率。
---

## 内置工具集详解

OpenCode 提供了丰富的内置工具集，让 AI 能够直接操作代码库。这些工具是 OpenCode 强大能力的基石，了解它们的工作原理和配置方式，能让你更好地控制 AI 的行为。

| 工具 | 功能 | 权限选项 | 使用场景 |
|------|------|----------|----------|
| **bash** | 执行 shell 命令 | allow/deny/ask | 运行测试、安装依赖、执行构建脚本 |
| **read** | 读取文件内容 | allow | 分析代码、理解项目结构 |
| **write** | 创建新文件 | allow/ask | 生成代码、创建配置文件 |
| **edit** | 修改文件内容 | allow/ask | 重构代码、修复 Bug |
| **patch** | 应用代码补丁 | allow/ask | 批量修改、跨文件重构 |
| **grep** | 搜索文件内容 | allow | 查找函数定义、定位问题代码 |
| **glob** | 列出匹配文件 | allow | 查找特定类型文件 |
| **list** | 列出目录内容 | allow | 浏览项目结构 |
| **webfetch** | 抓取网页内容 | allow | 获取 API 文档、技术文章 |
| **websearch** | 网络搜索 | allow（需 `OPENCODE_ENABLE_EXA=1`）| 查找解决方案、技术资料 |
| **skill** | 加载 SKILL.md 技能文件 | allow | 扩展 AI 能力、自定义工作流 |
| **todowrite** | 创建/更新任务清单 | allow | 项目管理、任务跟踪 |
| **todoread** | 读取任务清单 | allow | 查看任务进度 |
| **question** | 向用户提问 | allow | 获取用户输入、确认操作 |

### 权限配置

在 `opencode.json` 中可以精细控制工具权限：

```json
{
  "tools": {
    "bash": {
      "permission": "ask"
    },
    "write": {
      "permission": "allow",
      "patterns": ["src/**/*.ts", "tests/**/*.ts"]
    },
    "edit": {
      "permission": "allow",
      "patterns": ["src/**/*.ts"]
    },
    "read": {
      "permission": "allow"
    }
  }
}
```

## 高级 Slash 命令

除了基础命令，OpenCode 还提供了许多高级命令，帮助你更高效地使用：

| 命令 | 功能 | 使用场景 |
|------|------|----------|
| `/theme` | 切换主题 | 调整界面外观 |
| `/keybinds` | 自定义快捷键 | 个性化操作习惯 |
| `/export` | 导出对话为 Markdown | 整理和分享 |
| `/compact` | 压缩当前会话 | 总结上下文，节省 Token |

## 使用技巧

### 初级：快速上手

**技巧 1：自然语言提问**

直接描述你的需求，让 AI 理解并执行：

```
当前目录下创建一个登录页面，包含用户名和密码输入框
```

OpenCode 会自动生成所需的 HTML、CSS 和 JavaScript 文件。

**技巧 2：解释代码**

```
@utils.js 中的这个函数是做什么的？
```

AI 会详细解释函数的作用、参数、返回值和使用场景。

**技巧 3：快速修复**

```
修复 @app.py 中的语法错误
```

AI 会自动定位错误并提供修复方案。

**技巧 4：查看模型**

```
/models
```

切换不同 AI 模型对比效果，找到最适合你任务的模型。

**技巧 5：撤销操作**

```
/undo
```

需要项目在 Git 管理下才能使用，撤销 AI 的所有更改。

### 中级：提升效率

**技巧 6：Plan 模式规划**

复杂任务先用 Plan 模式：

1. 按 `Tab` 切换到 Plan 模式
2. 描述需求：

```
为用户模块添加删除功能：
1. 软删除标记
2. 回收站页面
3. 恢复和永久删除选项
```

3. 审查 AI 的方案，确认无误后
4. `Tab` 切回 Build 模式执行

**技巧 7：批量文件操作**

```
将所有 .js 文件中的 var 替换为 const
```

AI 会使用 grep 和 edit 工具批量修改所有匹配的文件。

**技巧 8：代码审查**

```
审查 @src/components 目录下的代码，找出潜在问题
```

AI 会分析代码质量、安全性、性能等方面的问题。

**技巧 9：添加图片参考**

拖拽图片到终端：

```
按照这个设计图实现页面布局
[图片已添加]
```

AI 会理解图片中的设计并实现对应的布局。

**技巧 10：会话管理**

```
/sessions    # 查看所有会话
/new         # 开始新会话
/compact     # 压缩当前会话（总结上下文）
```

有效管理会话可以提高效率，避免上下文过长。

### 高级：深度定制

**技巧 11：自定义命令**

创建自定义 Slash 命令，封装常用工作流：

```bash
mkdir -p ~/.config/opencode/commands
cat > ~/.config/opencode/commands/project-analysis.md << 'EOF'
---
agent: build
description: 全面分析当前工程，提供项目改进建议
---
## 你的任务

全面分析项目结构，理解其类型和核心价值，创建专业的 `README.md`文件。如果文档已存在，则智能补充更新。

## 执行流程

### 1. 扫描项目结构

使用 `Glob` 扫描：

- 根目录文件（配置、入口文件）
- 子目录结构
...
EOF
```

重启后输入 `/project-analysis` 使用。

**技巧 12：配置 MCP 服务器**

MCP（Model Context Protocol）扩展工具能力：

在 `opencode.json` 中添加：

```json
{
  "mcpServers": {
    "database": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-postgres"],
      "env": {
        "DATABASE_URL": "postgresql://..."
      }
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_TOKEN": "your_github_token"
      }
    }
  }
}
```

**技巧 13：权限精细控制**

编辑 `opencode.json`：

```json
{
  "tools": {
    "bash": {
      "permission": "ask"
    },
    "write": {
      "permission": "ask"
    },
    "edit": {
      "permission": "allow",
      "patterns": ["src/**/*.js"]
    }
  }
}
```

**技巧 14：使用 oh-my-opencode 扩展**

oh-my-opencode 是社区开发的多智能体协作框架，提供更强大的多智能体协作能力。它包含 Sisyphus 等多个专业 Agent，能够自动协调完成复杂任务。

> ⚠️ **安全警告**：oh-my-opencode 是免费开源项目，任何声称"官方"的付费网站都是冒充的。**只从 GitHub 官方仓库下载**：https://github.com/code-yeongyu/oh-my-opencode

**推荐安装方式（让 AI 自动配置）**：

将以下提示词粘贴给你的 AI 助手（如 Claude Code、Cursor）：

```
请帮我安装和配置 oh-my-opencode，按照以下指南操作：
https://raw.githubusercontent.com/code-yeongyu/oh-my-opencode/refs/heads/master/docs/guide/installation.md
```

**手动安装步骤**：

1.克隆仓库：
```bash
git clone https://github.com/code-yeongyu/oh-my-opencode.git ~/.opencode/oh-my-opencode
```

2.配置环境变量：
```bash
export OPENCODE_SKILLS_PATH=~/.opencode/oh-my-opencode
```

3.下载安装脚本：
```bash
curl -fsSL https://raw.githubusercontent.com/code-yeongyu/oh-my-opencode/refs/heads/master/docs/guide/installation.md -o /tmp/oh-my-opencode-install.md
```

4.查看详细文档：
```bash
cat /tmp/oh-my-opencode-install.md
```

**主要功能**：

- **Sisyphus**：主代理，使用 `ultrawork` 或 `ulw` 关键词触发，自动完成复杂任务
- **Hephaestus**：自主深度工作者，目标导向执行
- **Oracle**：设计和调试专家
- **Librarian**：文档和代码库搜索专家

详细文档和配置说明请访问：https://github.com/code-yeongyu/oh-my-opencode

**使用示例**：

```
ultrawork: 实现一个支持暗黑模式的 React 组件
```

或者简写：

```
ulw: 重构所有 API 路由，添加错误处理
```

**技巧 15：非交互模式脚本化**

适合 CI/CD 和自动化：

```bash
# 单次任务
opencode -p "生成项目 README"

# 指定目录
opencode -c ~/my-project -p "修复 lint 错误"

# JSON 输出
opencode -p "检查代码质量" -f json
```

**技巧 16：自定义主题和快捷键**

```
/theme    # 切换主题
/keybinds # 自定义快捷键
```

**技巧 17：导出对话**

```
/export   # 导出为 Markdown
```

便于整理和分享。

**技巧 18：多会话并行**

同时开启多个 OpenCode 实例处理不同任务。

**技巧 19：IDE 集成**

VS Code 安装 OpenCode 扩展，获得无缝体验。

## 实战案例

### 案例 1：快速创建 Node.js API

**步骤**：

1.创建目录：

   ```bash
   mkdir my-api && cd my-api
   npm init -y
   ```

2.启动 OpenCode：

   ```bash
   opencode
   ```

3.初始化项目：

   ```
   /init
   ```

4.描述需求：

   ```
   创建一个 Express.js 服务：
   - /hello 路由返回 JSON { message: 'Hello World' }
   - 添加错误处理中间件
   - 包含 README 使用说明
   ```

5. AI 自动生成代码和文档

### 案例 2：代码重构

**场景**：将回调函数重构为 async/await

```
将 @src/utils.js 中的所有回调函数改为 async/await 风格
```

AI 会：
- 分析文件
- 展示修改计划
- 执行重构
- 验证语法正确性

### 案例 3：Bug 修复流程

**步骤**：

1.描述问题：

```
用户反馈登录接口偶尔返回 500 错误，请定位并修复
```

2.AI 分析相关文件
3.提出修复方案
4.执行修复并测试

## GitHub Actions 集成

OpenCode 可以直接集成到 GitHub Actions 中，在 PR 和 Issue 中使用 `/opencode` 或 `/oc` 命令触发 AI 自动完成任务。

### 主要功能

- **自动修复 Issue**：在 Issue 中评论 `/opencode fix this`，自动创建分支、修复问题并提交 PR
- **PR 代码审查**：在 PR 中评论，自动审查代码或执行修改
- **定时任务**：通过 cron 定时运行 OpenCode 执行自动化任务
- **代码行级评论**：在 PR 的具体代码行上评论，OpenCode 会理解上下文并响应

### 安装配置

在项目中运行（确保已在 GitHub 仓库目录下）：

```bash
opencode github install
```

这会引导你完成：
1. 安装 OpenCode GitHub App
2. 创建 workflow 文件
3. 配置 API Key

### 使用示例

**自动修复 Bug**：
```
在 GitHub Issue 中评论：
/opencode 这个登录接口偶尔返回 500 错误，请定位并修复
```

**PR 代码修改**：
```
在 PR 中评论：
/opencode 在删除用户时添加软删除逻辑
```

**定时代码审查**：
```yaml
# .github/workflows/opencode-scheduled.yml
name: Weekly Code Review
on:
  schedule:
    - cron: "0 9 * * 1"  # 每周一上午 9 点
jobs:
  review:
    runs-on: ubuntu-latest
    permissions:
      id-token: write
      contents: write
      pull-requests: write
      issues: write
    steps:
      - uses: actions/checkout@v6
        with:
          fetch-depth: 1
          persist-credentials: false
      - uses: anomalyco/opencode/github@latest
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
        with:
          model: anthropic/claude-sonnet-4-20250514
          prompt: |
            审查本周的代码变更，找出潜在问题并提供建议
```

## 资源链接

- **官网**：[https://opencode.ai](https://opencode.ai)
- **GitHub**：[https://github.com/anomalyco/opencode](https://github.com/anomalyco/opencode)
- **文档**：[https://opencode.ai/docs](https://opencode.ai/docs)
- **Discord 社区**：[https://opencode.ai/discord](https://opencode.ai/discord)
